import { CACHE_TAGS } from "./tags";

/**
 * Revalidation Strategy Map
 *
 * Định nghĩa các tags cần được revalidate khi có thay đổi dữ liệu
 * theo từng action cụ thể
 */

export const REVALIDATION_MAP = {
  // ==================== PRODUCT ACTIONS ====================
  PRODUCT_CREATE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.LAYOUT.WEB,
  ],

  PRODUCT_UPDATE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.PRODUCTS.DETAILS,
    CACHE_TAGS.PRODUCTS.RELATED,
    CACHE_TAGS.CATEGORIES.ALL, // Categories might be affected
    CACHE_TAGS.CATEGORIES.ACTIVE, // Category lists
    CACHE_TAGS.LAYOUT.WEB, // Layout might show product info
  ],

  PRODUCT_DELETE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.PRODUCTS.DETAILS,
    CACHE_TAGS.PRODUCTS.RELATED,
    CACHE_TAGS.CATEGORIES.ALL, // Category counts affected
    CACHE_TAGS.CATEGORIES.ACTIVE,
    CACHE_TAGS.LAYOUT.WEB,
  ],

  PRODUCT_STATUS_CHANGE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
  ],

  // ==================== CATEGORY ACTIONS ====================
  CATEGORY_CREATE: [
    CACHE_TAGS.CATEGORIES.ALL,
    CACHE_TAGS.CATEGORIES.ACTIVE,
    CACHE_TAGS.CATEGORIES.ADMIN_LIST,
    CACHE_TAGS.LAYOUT.WEB,
  ],

  CATEGORY_UPDATE: [
    CACHE_TAGS.CATEGORIES.ALL,
    CACHE_TAGS.CATEGORIES.ACTIVE,
    CACHE_TAGS.CATEGORIES.ADMIN_LIST,
    CACHE_TAGS.CATEGORIES.WITH_PRODUCTS,
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.LAYOUT.WEB,
  ],

  CATEGORY_DELETE: [
    CACHE_TAGS.CATEGORIES.ALL,
    CACHE_TAGS.CATEGORIES.ACTIVE,
    CACHE_TAGS.CATEGORIES.ADMIN_LIST,
    CACHE_TAGS.CATEGORIES.WITH_PRODUCTS,
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.LAYOUT.WEB,
  ],

  // ==================== ORDER ACTIONS ====================
  ORDER_CREATE: [
    CACHE_TAGS.ORDERS.ALL,
    CACHE_TAGS.ORDERS.ADMIN_LIST,
    CACHE_TAGS.ORDERS.STATISTICS,
  ],

  ORDER_STATUS_UPDATE: [
    CACHE_TAGS.ORDERS.ALL,
    CACHE_TAGS.ORDERS.ADMIN_LIST,
    CACHE_TAGS.ORDERS.STATISTICS,
  ],

  ORDER_UPDATE: [CACHE_TAGS.ORDERS.ALL, CACHE_TAGS.ORDERS.ADMIN_LIST],

  // ==================== CONFIG ACTIONS ====================
  CONFIG_UPDATE: [
    CACHE_TAGS.CONFIGS.ALL,
    CACHE_TAGS.LAYOUT.WEB,
    CACHE_TAGS.LAYOUT.ADMIN,
  ],

  CONFIG_UI_UPDATE: [
    CACHE_TAGS.CONFIGS.ALL,
    CACHE_TAGS.CONFIGS.UI,
    CACHE_TAGS.LAYOUT.WEB,
  ],

  CONFIG_APP_UPDATE: [
    CACHE_TAGS.CONFIGS.ALL,
    CACHE_TAGS.CONFIGS.APP,
    CACHE_TAGS.LAYOUT.ADMIN,
  ],

  // ==================== CUSTOMER ACTIONS ====================
  CUSTOMER_CREATE: [CACHE_TAGS.CUSTOMERS.ALL, CACHE_TAGS.CUSTOMERS.ADMIN_LIST],

  CUSTOMER_UPDATE: [CACHE_TAGS.CUSTOMERS.ALL, CACHE_TAGS.CUSTOMERS.ADMIN_LIST],

  // ==================== RESERVATION ACTIONS ====================
  RESERVATION_CREATE: [
    CACHE_TAGS.RESERVATIONS.ALL,
    CACHE_TAGS.RESERVATIONS.ADMIN_LIST,
  ],

  RESERVATION_UPDATE: [
    CACHE_TAGS.RESERVATIONS.ALL,
    CACHE_TAGS.RESERVATIONS.ADMIN_LIST,
  ],

  RESERVATION_STATUS_UPDATE: [
    CACHE_TAGS.RESERVATIONS.ALL,
    CACHE_TAGS.RESERVATIONS.ADMIN_LIST,
  ],

  // ==================== IMAGE ACTIONS ====================
  IMAGE_UPLOAD: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.PRODUCTS.DETAILS,
  ],

  IMAGE_DELETE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.PRODUCTS.DETAILS,
  ],

  // ==================== ADDON ACTIONS ====================
  ADDON_CREATE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.PRODUCTS.DETAILS,
  ],

  ADDON_UPDATE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.PRODUCTS.DETAILS,
  ],

  ADDON_DELETE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
    CACHE_TAGS.PRODUCTS.DETAILS,
  ],

  // ==================== CART ACTIONS ====================
  CART_UPDATE: [
    CACHE_TAGS.PRODUCTS.ALL, // Cart validation might need product data
  ],

  // ==================== CATEGORY RELATION ACTIONS ====================
  CATEGORY_PRODUCT_ADD: [
    CACHE_TAGS.CATEGORIES.ALL,
    CACHE_TAGS.CATEGORIES.ACTIVE,
    CACHE_TAGS.CATEGORIES.WITH_PRODUCTS,
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
  ],

  CATEGORY_PRODUCT_REMOVE: [
    CACHE_TAGS.CATEGORIES.ALL,
    CACHE_TAGS.CATEGORIES.ACTIVE,
    CACHE_TAGS.CATEGORIES.WITH_PRODUCTS,
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
  ],

  // ==================== BULK ACTIONS ====================
  BULK_PRODUCT_UPDATE: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.PRODUCTS.LIST,
    CACHE_TAGS.PRODUCTS.ADMIN_LIST,
  ],

  BULK_ORDER_UPDATE: [
    CACHE_TAGS.ORDERS.ALL,
    CACHE_TAGS.ORDERS.ADMIN_LIST,
    CACHE_TAGS.ORDERS.STATISTICS,
  ],

  // ==================== SPECIAL CASES ====================
  FULL_REFRESH: [
    CACHE_TAGS.PRODUCTS.ALL,
    CACHE_TAGS.CATEGORIES.ALL,
    CACHE_TAGS.ORDERS.ALL,
    CACHE_TAGS.CONFIGS.ALL,
    CACHE_TAGS.CUSTOMERS.ALL,
    CACHE_TAGS.RESERVATIONS.ALL,
    CACHE_TAGS.LAYOUT.WEB,
    CACHE_TAGS.LAYOUT.ADMIN,
  ],
} as const;

export type RevalidationAction = keyof typeof REVALIDATION_MAP;
